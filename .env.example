# ============================================================================
# App
# ============================================================================
NODE_ENV=development  #development, production, test
PORT=3000
LOG_LEVEL=debug       #error, warn, info, debug

# ============================================================================
# Database Configuration
# ============================================================================
DATABASE_HOST=localhost
DATABASE_USER=juel
DATABASE_PASSWORD=123
DATABASE_PORT=5432
DATABASE_NAME=nest
DATABASE_SCHEMA=public
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=public
CONTAINER_NAME=Auth_postgres_NEW

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_CACHE_EXPIRATION=3600
REDIS_CONTAINER_NAME=Auth_redis_NEW

# ============================================================================
# OTP(One-Time Password) Email Security Configuration
# ============================================================================
OTP_EXPIRE_TIME=5
OTP_MAX_FAILED_ATTEMPTS=5
OTP_LOCKOUT_TIME=5
OTP_SENDER_MAIL_HOST=smtp.office365.com
OTP_SENDER_MAIL_PORT=587
OTP_SENDER_MAIL="verification@xyz.com"
OTP_SENDER_MAIL_PASSWORD="12345"

# ============================================================================
# Google OAuth Configuration
# ============================================================================
GOOGLE_CLIENT_ID=1002101179111-8l6478svqjujtfaav3prup0d4u00j4k0.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSsX-flKssKyqQ1DEb1o3ss8PZtuD6-O0
GOOGLE_CALLBACK_URL=http://localhost:3000/auth/google/callback

# ============================================================================
# Facebook OAuth Configuration
# ============================================================================
FACEBOOK_CLIENT_ID=974295555582083
FACEBOOK_CLIENT_SECRET=f5df32076af455129657b555fd854c7d
FACEBOOK_CALLBACK_URL=http://localhost:3000/auth/facebook/callback

# ============================================================================
# JWT and JWE Secret Keys
# JSON Web Encryption (JWE). Each key should be exactly 32 characters long,
# ensuring they are 256 bits when properly encoded.
# ============================================================================
USE_JWE=true
JWE_ACCESS_TOKEN_SECRET=1234567890abcdef1234567890abcdef
JWT_ACCESS_TOKEN_SECRET=abcdefghijklmnopqrstuvwxyza123456
JWE_REFRESH_TOKEN_SECRET=abcdef1234567890abcdef1234567890
JWT_REFRESH_TOKEN_SECRET=abcdefghijklmnopqrstuvwxz1234567

# ============================================================================
# Token Expiration Configuration
# ============================================================================
JWE_JWT_ACCESS_TOKEN_EXPIRATION=86400s
JWE_JWT_REFRESH_TOKEN_EXPIRATION=30d

# ============================================================================
# JTI / Session Rotation Controls 
# ============================================================================
REFRESH_JTI_STRATEGY=uuid           # uuid | nanoid | random-bytes
REFRESH_JTI_LENGTH=21               # length for nanoid/random-bytes (typical: 21)
REFRESH_JTI_PREFIX=                 # optional prefix for jti (e.g., rjti_)
SESSION_ID_PREFIX=sid_              # session id prefix (e.g., sid_)
AUTH_REDIS_PREFIX=auth:             # Redis key prefix (e.g., auth:)
REFRESH_REUSE_POLICY=revoke_session # revoke_session | revoke_all | lock_user
AUTH_NO_STORE=true                  # send Cache-Control: no-store on auth routes

# ============================================================================
# Password Validation Configuration
# ============================================================================
BCRYPT_SALT_ROUNDS=14
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=20
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARACTERS=true
PASSWORD_DISALLOW_REPEATING=false
PASSWORD_DISALLOW_SEQUENTIAL=false
PASSWORD_BLACKLIST_COMMON=false
PASSWORD_EXCLUDE_USERNAME=true

# ============================================================================
# CORS
# ============================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4200
CORS_ALLOWED_ORIGIN_REGEX=
CORS_ALLOW_ORIGIN_WILDCARD=false
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOWED_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Requested-With,X-Internal-Api-Key

# ============================================================================
# Rate Limiting
# ============================================================================
THROTTLE_TTL=60000      # 60,000 milliseconds = 60 seconds
THROTTLE_LIMIT=100      # Maximum 100 requests per 60 seconds

# ============================================================================
# Geolocation
# ============================================================================
GEO_ENABLED=true
GEO_ALLOWED_COUNTRIES=US,CA,AU,BD

# ============================================================================
# DDoS Protection
# ============================================================================
DDOS_MAX_REQUESTS=1000    # Max 1000 requests per window
DDOS_WINDOW_SIZE=60       # 60 second window
DDOS_BLOCK_DURATION=3600  # Block for 1 hour (3600 seconds)

# ============================================================================
# Email Queue Configuration
# ============================================================================
EMAIL_QUEUE_CONCURRENCY=5        # Number of concurrent email jobs
EMAIL_QUEUE_MAX_ATTEMPTS=3       # Maximum retry attempts for failed emails
EMAIL_QUEUE_BACKOFF_DELAY=5000   # Delay between retries in milliseconds

# ============================================================================
# API Versioning Configuration
# ============================================================================
API_VERSIONING_ENABLED=true              # Enable/disable API versioning
API_VERSIONING_TYPE=uri                  # Versioning type: uri | header | media-type
API_DEFAULT_VERSION=1                    # Default API version
API_VERSION_HEADER_NAME=X-API-Version    # Header name for header-based versioning
API_VERSION_MEDIA_TYPE_KEY=v             # Media type key for media-type versioning